#max_complete$target <- as.factor(max_complete$target)
z_complete$LAM <- z_complete$android.sensor.linear_acceleration.mean^2
z_complete$G <- z_complete$android.sensor.gyroscope.mean^2
z_complete$SM <- z_complete$speed.mean^2
library(rpart)
library(rpart.plot)
training_data <- z_complete[1:4000,]
test <- z_complete[4001:5893,]
library(rpart)
library(rpart.plot)
training_data <- z_complete[1:4000,]
test <- z_complete[4001:5893,]
treefit2<-rpart(target~., data=training_data, method="class", parms=list(split = "information"),control = rpart.control(minsplit=2, cp=0))
bestcp <- treefit2$cptable[which.min(treefit2$cptable[,"xerror"]),"CP"]
tree.pruned <- prune(treefit2, cp = bestcp)
pred <- predict(tree.pruned,newdata=test, type="class")
truth<-test$target
table(truth,pred)
#table(pred)
#table(truth)
correct <- 0
for (i in 1:5) {
correct <- correct + table(truth,pred)[i,i]
}
correct/1893
pred <- predict(tree.pruned,newdata=training_data, type="class")
truth<-training_data$target
correct <- 0
for (i in 1:5) {
correct <- correct + table(truth,pred)[i,i]
}
correct/4000
z_complete$LAM <- z_complete$android.sensor.linear_acceleration.mean^2
z_complete$G <- z_complete$android.sensor.gyroscope.mean^2
z_complete$SM <- z_complete$speed.mean^3
treefit2<-rpart(target~., data=training_data, method="class", parms=list(split = "information"),control = rpart.control(minsplit=2, cp=0))
bestcp <- treefit2$cptable[which.min(treefit2$cptable[,"xerror"]),"CP"]
tree.pruned <- prune(treefit2, cp = bestcp)
pred <- predict(tree.pruned,newdata=test, type="class")
truth<-test$target
table(truth,pred)
#table(pred)
#table(truth)
correct <- 0
for (i in 1:5) {
correct <- correct + table(truth,pred)[i,i]
}
correct/1893
pred <- predict(tree.pruned,newdata=training_data, type="class")
truth<-training_data$target
correct <- 0
for (i in 1:5) {
correct <- correct + table(truth,pred)[i,i]
}
correct/4000
z_complete$LAM <- z_complete$android.sensor.linear_acceleration.mean^2
z_complete$G <- z_complete$android.sensor.gyroscope.mean^2
z_complete$SM <- z_complete$speed.mean^2
library(rpart)
library(rpart.plot)
training_data <- z_complete[1:4000,]
test <- z_complete[4001:5893,]
treefit2<-rpart(target~., data=training_data, method="class", parms=list(split = "information"),control = rpart.control(minsplit=2, cp=0))
bestcp <- treefit2$cptable[which.min(treefit2$cptable[,"xerror"]),"CP"]
tree.pruned <- prune(treefit2, cp = bestcp)
pred <- predict(tree.pruned,newdata=test, type="class")
truth<-test$target
table(truth,pred)
#table(pred)
#table(truth)
correct <- 0
for (i in 1:5) {
correct <- correct + table(truth,pred)[i,i]
}
correct/1893
pred <- predict(tree.pruned,newdata=training_data, type="class")
truth<-training_data$target
correct <- 0
for (i in 1:5) {
correct <- correct + table(truth,pred)[i,i]
}
correct/4000
treefit2<-rpart(target~., data=training_data, method="class", parms=list(split = "information"),control = rpart.control(minsplit=2, cp=0))
bestcp <- treefit2$cptable[which.min(treefit2$cptable[,"xerror"]),"CP"]
tree.pruned <- prune(treefit2, cp = bestcp)
pred <- predict(tree.pruned,newdata=test, type="class")
truth<-test$target
table(truth,pred)
#table(pred)
#table(truth)
correct <- 0
for (i in 1:5) {
correct <- correct + table(truth,pred)[i,i]
}
correct/1893
pred <- predict(tree.pruned,newdata=training_data, type="class")
truth<-training_data$target
correct <- 0
for (i in 1:5) {
correct <- correct + table(truth,pred)[i,i]
}
correct/4000
treefit2<-rpart(target~., data=training_data, method="class", parms=list(split = "information"),control = rpart.control(minsplit=2, cp=0))
bestcp <- treefit2$cptable[which.min(treefit2$cptable[,"xerror"]),"CP"]
tree.pruned <- prune(treefit2, cp = bestcp)
pred <- predict(tree.pruned,newdata=test, type="class")
truth<-test$target
table(truth,pred)
#table(pred)
#table(truth)
correct <- 0
for (i in 1:5) {
correct <- correct + table(truth,pred)[i,i]
}
correct/1893
pred <- predict(tree.pruned,newdata=training_data, type="class")
truth<-training_data$target
correct <- 0
for (i in 1:5) {
correct <- correct + table(truth,pred)[i,i]
}
correct/4000
treefit2<-rpart(target~., data=training_data, method="class", parms=list(split = "information"),control = rpart.control(minsplit=2, cp=0))
bestcp <- treefit2$cptable[which.min(treefit2$cptable[,"xerror"]),"CP"]
tree.pruned <- prune(treefit2, cp = bestcp)
pred <- predict(tree.pruned,newdata=test, type="class")
truth<-test$target
table(truth,pred)
#table(pred)
#table(truth)
correct <- 0
for (i in 1:5) {
correct <- correct + table(truth,pred)[i,i]
}
correct/1893
pred <- predict(tree.pruned,newdata=training_data, type="class")
truth<-training_data$target
correct <- 0
for (i in 1:5) {
correct <- correct + table(truth,pred)[i,i]
}
correct/4000
treefit2<-rpart(target~., data=training_data, method="class", parms=list(split = "information"),control = rpart.control(minsplit=2, cp=0))
bestcp <- treefit2$cptable[which.min(treefit2$cptable[,"xerror"]),"CP"]
tree.pruned <- prune(treefit2, cp = bestcp)
pred <- predict(tree.pruned,newdata=test, type="class")
truth<-test$target
table(truth,pred)
#table(pred)
#table(truth)
correct <- 0
for (i in 1:5) {
correct <- correct + table(truth,pred)[i,i]
}
correct/1893
pred <- predict(tree.pruned,newdata=training_data, type="class")
truth<-training_data$target
correct <- 0
for (i in 1:5) {
correct <- correct + table(truth,pred)[i,i]
}
correct/4000
tree.pruned$variable.importance
complete<-read.csv(file="C:/Users/alber/Downloads/Classes/Stat 385/final project/complete_data.csv",header=TRUE)
z_complete<-read.csv(file="C:/Users/alber/Downloads/Classes/Stat 385/final project/z_complete.csv",header=TRUE)
complete<-read.csv(file="C:/Users/alber/Downloads/Classes/Stat 385/final project/complete_data.csv",header=TRUE)
z_complete<-read.csv(file="C:/Users/alber/Downloads/Classes/Stat 385/final project/z_complete.csv",header=TRUE)
z_complete$target <- as.factor(z_complete$target)
#max_complete$target <- as.factor(max_complete$target)
library(rpart)
library(rpart.plot)
#training_data <- z_complete[1:4000,]
#test <- z_complete[4001:5893,]
training_data <- complete[1:4000,]
test <- complete[4001:5893,]
treefit2<-rpart(target~., data=training_data, method="class", parms=list(split = "information"),control = rpart.control(minsplit=2, cp=0))
bestcp <- treefit2$cptable[which.min(treefit2$cptable[,"xerror"]),"CP"]
tree.pruned <- prune(treefit2, cp = bestcp)
pred <- predict(tree.pruned,newdata=test, type="class")
truth<-test$target
table(truth,pred)
#table(pred)
#table(truth)
correct <- 0
for (i in 1:5) {
correct <- correct + table(truth,pred)[i,i]
}
correct/1893
pred <- predict(tree.pruned,newdata=training_data, type="class")
truth<-training_data$target
correct <- 0
for (i in 1:5) {
correct <- correct + table(truth,pred)[i,i]
}
correct/4000
tree.pruned$variable.importance
z_complete<-read.csv(file="C:/Users/alber/Downloads/Classes/Stat 385/final project/z_complete.csv",header=TRUE)
z_complete$target <- as.factor(z_complete$target)
complete<-read.csv(file="C:/Users/alber/Downloads/Classes/Stat 385/final project/complete_data.csv",header=TRUE)
complete$target <- as.factor(complete$target)
#max_complete$target <- as.factor(max_complete$target)
a <- seq(1:5)
e^^a
e**a
3^^a
3^2
3**a
z_complete$time
z_complete$LAM <- z_complete$android.sensor.linear_acceleration.mean^2
z_complete$G <- z_complete$android.sensor.gyroscope.mean^2
z_complete$SM <- z_complete$speed.mean^2
z_complete$T <- 1.1**z_complete$time
library(rpart)
library(rpart.plot)
training_data <- z_complete[1:4000,]
test <- z_complete[4001:5893,]
#training_data <- complete[1:4000,]
#test <- complete[4001:5893,]
treefit2<-rpart(target~., data=training_data, method="class", parms=list(split = "information"),control = rpart.control(minsplit=2, cp=0))
bestcp <- treefit2$cptable[which.min(treefit2$cptable[,"xerror"]),"CP"]
tree.pruned <- prune(treefit2, cp = bestcp)
pred <- predict(tree.pruned,newdata=test, type="class")
truth<-test$target
table(truth,pred)
#table(pred)
#table(truth)
correct <- 0
for (i in 1:5) {
correct <- correct + table(truth,pred)[i,i]
}
correct/1893
pred <- predict(tree.pruned,newdata=training_data, type="class")
truth<-training_data$target
correct <- 0
for (i in 1:5) {
correct <- correct + table(truth,pred)[i,i]
}
correct/4000
tree.pruned$variable.importance
pred <- predict(tree.pruned,newdata=test, type="class")
truth<-test$target
table(truth,pred)
#table(pred)
#table(truth)
correct <- 0
for (i in 1:5) {
correct <- correct + table(truth,pred)[i,i]
}
correct/1893
pred <- predict(tree.pruned,newdata=training_data, type="class")
truth<-training_data$target
correct <- 0
for (i in 1:5) {
correct <- correct + table(truth,pred)[i,i]
}
correct/4000
treefit2<-rpart(target~., data=training_data, method="class", parms=list(split = "information"),control = rpart.control(minsplit=2, cp=0))
bestcp <- treefit2$cptable[which.min(treefit2$cptable[,"xerror"]),"CP"]
tree.pruned <- prune(treefit2, cp = bestcp)
pred <- predict(tree.pruned,newdata=test, type="class")
truth<-test$target
table(truth,pred)
#table(pred)
#table(truth)
correct <- 0
for (i in 1:5) {
correct <- correct + table(truth,pred)[i,i]
}
correct/1893
pred <- predict(tree.pruned,newdata=training_data, type="class")
truth<-training_data$target
correct <- 0
for (i in 1:5) {
correct <- correct + table(truth,pred)[i,i]
}
correct/4000
tree.pruned$variable.importance
z_complete$T
z_complete$LAM <- z_complete$android.sensor.linear_acceleration.mean^2
z_complete$G <- z_complete$android.sensor.gyroscope.mean^2
z_complete$SM <- z_complete$speed.mean^2
z_complete$T <- 1.5**z_complete$time
treefit2<-rpart(target~., data=training_data, method="class", parms=list(split = "information"),control = rpart.control(minsplit=2, cp=0))
bestcp <- treefit2$cptable[which.min(treefit2$cptable[,"xerror"]),"CP"]
tree.pruned <- prune(treefit2, cp = bestcp)
pred <- predict(tree.pruned,newdata=test, type="class")
truth<-test$target
table(truth,pred)
#table(pred)
#table(truth)
correct <- 0
for (i in 1:5) {
correct <- correct + table(truth,pred)[i,i]
}
correct/1893
pred <- predict(tree.pruned,newdata=training_data, type="class")
truth<-training_data$target
correct <- 0
for (i in 1:5) {
correct <- correct + table(truth,pred)[i,i]
}
correct/4000
treefit2<-rpart(target~., data=training_data, method="class", parms=list(split = "information"),control = rpart.control(minsplit=2, cp=0))
bestcp <- treefit2$cptable[which.min(treefit2$cptable[,"xerror"]),"CP"]
tree.pruned <- prune(treefit2, cp = bestcp)
pred <- predict(tree.pruned,newdata=test, type="class")
truth<-test$target
table(truth,pred)
#table(pred)
#table(truth)
correct <- 0
for (i in 1:5) {
correct <- correct + table(truth,pred)[i,i]
}
correct/1893
pred <- predict(tree.pruned,newdata=training_data, type="class")
truth<-training_data$target
correct <- 0
for (i in 1:5) {
correct <- correct + table(truth,pred)[i,i]
}
correct/4000
treefit2<-rpart(target~., data=training_data, method="class", parms=list(split = "information"),control = rpart.control(minsplit=2, cp=0))
bestcp <- treefit2$cptable[which.min(treefit2$cptable[,"xerror"]),"CP"]
tree.pruned <- prune(treefit2, cp = bestcp)
pred <- predict(tree.pruned,newdata=test, type="class")
truth<-test$target
table(truth,pred)
#table(pred)
#table(truth)
correct <- 0
for (i in 1:5) {
correct <- correct + table(truth,pred)[i,i]
}
correct/1893
pred <- predict(tree.pruned,newdata=training_data, type="class")
truth<-training_data$target
correct <- 0
for (i in 1:5) {
correct <- correct + table(truth,pred)[i,i]
}
correct/4000
tree.pruned$variable.importance
z_complete<-read.csv(file="C:/Users/alber/Downloads/Classes/Stat 385/final project/z_complete.csv",header=TRUE)
z_complete$target <- as.factor(z_complete$target)
complete<-read.csv(file="C:/Users/alber/Downloads/Classes/Stat 385/final project/complete_data.csv",header=TRUE)
z_complete<-read.csv(file="C:/Users/alber/Downloads/Classes/Stat 385/final project/z_complete.csv",header=TRUE)
z_complete$target <- as.factor(z_complete$target)
complete<-read.csv(file="C:/Users/alber/Downloads/Classes/Stat 385/final project/complete_data.csv",header=TRUE)
complete$target <- as.factor(complete$target)
#max_complete$target <- as.factor(max_complete$target)
z_complete$LAM <- z_complete$android.sensor.linear_acceleration.mean^2
z_complete$G <- z_complete$android.sensor.gyroscope.mean^2
#z_complete$SM <- z_complete$speed.mean^2
#z_complete$T <- 1.5**z_complete$time
library(rpart)
library(rpart.plot)
training_data <- z_complete[1:4000,]
test <- z_complete[4001:5893,]
#training_data <- complete[1:4000,]
#test <- complete[4001:5893,]
treefit2<-rpart(target~., data=training_data, method="class", parms=list(split = "information"),control = rpart.control(minsplit=2, cp=0))
bestcp <- treefit2$cptable[which.min(treefit2$cptable[,"xerror"]),"CP"]
tree.pruned <- prune(treefit2, cp = bestcp)
pred <- predict(tree.pruned,newdata=test, type="class")
truth<-test$target
table(truth,pred)
#table(pred)
#table(truth)
correct <- 0
for (i in 1:5) {
correct <- correct + table(truth,pred)[i,i]
}
correct/1893
pred <- predict(tree.pruned,newdata=training_data, type="class")
truth<-training_data$target
correct <- 0
for (i in 1:5) {
correct <- correct + table(truth,pred)[i,i]
}
correct/4000
treefit2<-rpart(target~., data=training_data, method="class", parms=list(split = "information"),control = rpart.control(minsplit=2, cp=0))
bestcp <- treefit2$cptable[which.min(treefit2$cptable[,"xerror"]),"CP"]
tree.pruned <- prune(treefit2, cp = bestcp)
pred <- predict(tree.pruned,newdata=test, type="class")
truth<-test$target
table(truth,pred)
#table(pred)
#table(truth)
correct <- 0
for (i in 1:5) {
correct <- correct + table(truth,pred)[i,i]
}
correct/1893
pred <- predict(tree.pruned,newdata=training_data, type="class")
truth<-training_data$target
correct <- 0
for (i in 1:5) {
correct <- correct + table(truth,pred)[i,i]
}
correct/4000
z_complete<-read.csv(file="C:/Users/alber/Downloads/Classes/Stat 385/final project/z_complete.csv",header=TRUE)
z_complete$target <- as.factor(z_complete$target)
complete<-read.csv(file="C:/Users/alber/Downloads/Classes/Stat 385/final project/complete_data.csv",header=TRUE)
complete$target <- as.factor(complete$target)
#max_complete$target <- as.factor(max_complete$target)
#z_complete$LAM <- z_complete$android.sensor.linear_acceleration.mean^2
z_complete$G <- z_complete$android.sensor.gyroscope.mean^2
#z_complete$SM <- z_complete$speed.mean^2
#z_complete$T <- 1.5**z_complete$time
library(rpart)
library(rpart.plot)
training_data <- z_complete[1:4000,]
test <- z_complete[4001:5893,]
#training_data <- complete[1:4000,]
#test <- complete[4001:5893,]
treefit2<-rpart(target~., data=training_data, method="class", parms=list(split = "information"),control = rpart.control(minsplit=2, cp=0))
bestcp <- treefit2$cptable[which.min(treefit2$cptable[,"xerror"]),"CP"]
tree.pruned <- prune(treefit2, cp = bestcp)
pred <- predict(tree.pruned,newdata=test, type="class")
truth<-test$target
table(truth,pred)
#table(pred)
#table(truth)
correct <- 0
for (i in 1:5) {
correct <- correct + table(truth,pred)[i,i]
}
correct/1893
pred <- predict(tree.pruned,newdata=training_data, type="class")
truth<-training_data$target
correct <- 0
for (i in 1:5) {
correct <- correct + table(truth,pred)[i,i]
}
correct/4000
treefit2<-rpart(target~., data=training_data, method="class", parms=list(split = "information"),control = rpart.control(minsplit=2, cp=0))
bestcp <- treefit2$cptable[which.min(treefit2$cptable[,"xerror"]),"CP"]
tree.pruned <- prune(treefit2, cp = bestcp)
pred <- predict(tree.pruned,newdata=test, type="class")
truth<-test$target
table(truth,pred)
#table(pred)
#table(truth)
correct <- 0
for (i in 1:5) {
correct <- correct + table(truth,pred)[i,i]
}
correct/1893
pred <- predict(tree.pruned,newdata=training_data, type="class")
truth<-training_data$target
correct <- 0
for (i in 1:5) {
correct <- correct + table(truth,pred)[i,i]
}
correct/4000
treefit2<-rpart(target~., data=training_data, method="class", parms=list(split = "information"),control = rpart.control(minsplit=2, cp=0))
bestcp <- treefit2$cptable[which.min(treefit2$cptable[,"xerror"]),"CP"]
tree.pruned <- prune(treefit2, cp = bestcp)
pred <- predict(tree.pruned,newdata=test, type="class")
truth<-test$target
table(truth,pred)
#table(pred)
#table(truth)
correct <- 0
for (i in 1:5) {
correct <- correct + table(truth,pred)[i,i]
}
correct/1893
pred <- predict(tree.pruned,newdata=training_data, type="class")
truth<-training_data$target
correct <- 0
for (i in 1:5) {
correct <- correct + table(truth,pred)[i,i]
}
correct/4000
z_complete<-read.csv(file="C:/Users/alber/Downloads/Classes/Stat 385/final project/z_complete.csv",header=TRUE)
z_complete$target <- as.factor(z_complete$target)
complete<-read.csv(file="C:/Users/alber/Downloads/Classes/Stat 385/final project/complete_data.csv",header=TRUE)
complete$target <- as.factor(complete$target)
#max_complete$target <- as.factor(max_complete$target)
library(rpart)
library(rpart.plot)
training_data <- z_complete[1:4000,]
test <- z_complete[4001:5893,]
#training_data <- complete[1:4000,]
#test <- complete[4001:5893,]
treefit2<-rpart(target~., data=training_data, method="class", parms=list(split = "information"),control = rpart.control(minsplit=2, cp=0))
bestcp <- treefit2$cptable[which.min(treefit2$cptable[,"xerror"]),"CP"]
tree.pruned <- prune(treefit2, cp = bestcp)
pred <- predict(tree.pruned,newdata=test, type="class")
truth<-test$target
table(truth,pred)
#table(pred)
#table(truth)
correct <- 0
for (i in 1:5) {
correct <- correct + table(truth,pred)[i,i]
}
correct/1893
pred <- predict(tree.pruned,newdata=training_data, type="class")
truth<-training_data$target
correct <- 0
for (i in 1:5) {
correct <- correct + table(truth,pred)[i,i]
}
correct/4000
z_complete<-read.csv(file="C:/Users/alber/Downloads/Classes/Stat 385/final project/z_complete.csv",header=TRUE)
z_complete$target <- as.factor(z_complete$target)
complete<-read.csv(file="C:/Users/alber/Downloads/Classes/Stat 385/final project/complete_data.csv",header=TRUE)
complete$target <- as.factor(complete$target)
#max_complete$target <- as.factor(max_complete$target)
